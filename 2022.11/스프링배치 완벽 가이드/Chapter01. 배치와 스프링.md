# Chapter 01. 배치와 스프링

배치 처리의 역사, 배치 잡 개발의 어려움, 자바와 스프링 프레임워크를 사용해 배치를 개발해야 하는 필요성,
스프링 배치 프레임워크의 개요 및 기능에 대해 대략적으로 설명

### 배치 처리의 역사
-> 웹 쪽은 많은 고급 언어들이 등장, 배치 쪽에서는 COBOL을 압도적으로 많이 사용  
-> 각기 환경(POS, unix 등)에 맞는 배치가 각각 존재, 공통적 기능 x
-> 엑센츄어사가 뛰어들어 JVM 배치 처리의 표준이 됨

### 배치가 직면한 과제
-> 사용성 : 오류 처리 및 유지 보수성  
- 새로운 기능 확장이 가능한가?
- 단위 테스트가 잘 마련되어 있는가?
- 오랜 시간 소비 없이 어디가 잘못되었는지 알아낼 수 있는가?

-> 확장성 : 다량의 트랜잭션을 처리하는 경우를 고려하였는지
- 10만개의 트랜잭션을 처리하는 데 3개월 이상의 시간이 걸리는 게 맞는가?

-> 가용성 : 주어진 시간에 제대로 처리 되는지
- 필요할 때 바로 배치 처리를 수행할 수 있는가?
- 허용된 시간 내에 잡을 수행하는데 다른 시스템에 영향 없게 할 수 있는가?

-> 보안 : 데이터의 안전한 저장(암호화, 개인정보 로깅 여부 확인, 데이터 유효성 검증)

### 왜 자바로 배치를 처리하는가?
1. 유지보수성 : 스프링이 제공하는 테스트, 추상화, 의존성 주입을 통한 결합 제거 등을 활용할 수 있음(직접 자바 I/O, DB 연결까지 안건드려도 됨)
2. 유연성 : JVM은 여러 OS 위에서 돌아갈 수 있으므로 스프링 배치도 유연하게 적용 가능
3. 확장성 : 분산 환경에서 어떻게 동작해야 하는지 고려하지 않고 스프링 배치를 사용하면 됨
4. 개발 리소스 : 개발 인력을 찾기 쉬움. 스프링은 인기있는 프레임워크!
5. 지원 : 스택 오버플로나 깃헙 온라인 커뮤니티가 잘 갖춰짐
6. 비용 : 라이선스 비용 및 하드웨어 지원 계약보다 저렴

### 스프링 배치의 기타 사용 사례
- ETL(Extract-Transform-Load) : 청크 기반 처리, 압도적 확장 기능이 ETL 워크로드에 꼭 맞음
- 데이터 마이그레이션 : 제대로 구현하지 않은 커밋 횟수 측정, 롤백 기능 제공받을 수 있음
- 병렬 처리 : 스프링은 직접 마스터/워커 스텝 구성해줌
- 워크로드 조정 : 클라우드 데이터 플로우, 사용자 UI도 제공
- 무중단 처리 또는 상시 데이터 처리 : 청크 단위로 모아서 배치 처리, 큐에서 메시지 읽고 처크 단위로 배치 처리 수행

### 스프링 배치 프레임워크
애플리케이션 레이어, 코어 레이어, 인프라스트럭처 레이어로 구성
- 애플리케이션 레이어
  - 코어 레이어와 인프라 스트럭처 레이어를 감싸고 있음
  - 업무로직, 서비스, 사용자 코드 및 구성 모두 포함
  - 대부분 코어 레이어와 상호작용
- 코어 레이어
  - Job interface, Step interface, JobLauncher, JobParameters 등의 요소가 존재
- 인프라스트럭처 레이어
  - 파일, 데이터베이스 등으로부터 읽고 쓸 수 있게 해줌
  - 간혹 custom reader나 writer로 인프라스트럭처 레이어의 일부를 애플리케이션 레이어에서 만들기도 함
  - 잡 실행에 실패하고 재시도 될 때 어떤 일을 수행할지 다룸
  - ItemReader, ItemWriter 등의 요소가 존재

#### 스프링 배치의 일부 기능 자세히 설명하는 부분 이어짐, 해당 부분의 목차 나열
- 스프링으로 잡 정의하기
- 잡 관리하기
- 로컬 및 원격 병렬화
- I/O 표준화하기
- 나머지 스프링 배치 에코 시스템
  - 스프링 부트
  - 스프링 클라우드 태스크
  - 스프링 클라우드 데이터 플로우
- 스프링의 모든 기능

